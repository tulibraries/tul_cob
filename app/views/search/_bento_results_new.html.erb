<% grid_index = 0 %>

<div class="<%= results_class %>" data-controller="bento-masonry">
    <% renderable_results(results, options).each_pair do |engine_id, result| %>
      <% if engine_id == 'journals' && with_libguides? %>
        <div data-lib-guides-url="<%= lib_guides_path(q: @lib_guides_query_term) %>" data-controller="lib-guides">
          <%= render partial: "lib_guide_recommender_bento_new" %>
        </div>
      <% end %>
      <% next if engine_id == "archival_collections" && !aspace_integration_enabled? %>
      <% next if ["cdm", "lib_guides"].include?(engine_id) %>

      <%= render partial: "search/bento_engine_card", locals: {
            engine_id:,
            result:,
            wrapper_class: bento_grid_position_class(grid_index) } %>
      <% grid_index += 1 %>
    <% end %>
</div>
