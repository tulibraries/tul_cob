<% doc_presenter = show_presenter(document) %>
<%# default partial to display solr document fields in catalog show view -%>
<div class="show_page_records">
  <dl class="dl-horizontal  dl-invert">
    <dt class="blacklight-availability">Status/Location:</dt>
    <dd class="blacklight-availability availability-ajax-load" data-availability-ids="<%= document.alma_availability_mms_ids.join(',') %>">Loading...</dd>

    <% document_show_fields(document).each do |field_name, field| -%>
        <% if should_render_show_field? document, field %>
          <% if field.linked_fielded_search %>
            <dt class="blacklight-<%= field_name.parameterize %>">
              <%= render_document_show_field_label document, :field => field_name %>
            </dt>
            <% if field.multi %>
                <% document[field.field].each do |fvalue| %>
                    <dd class="blacklight-<%= field_name.parameterize %>"><%= fielded_search(fvalue, field.linked_fielded_search) %></dd>
                <% end -%>
            <% else %>
                <dd class="blacklight-<%= field_name.parameterize %>">
                    <%= fielded_search(document[field.field], field.linked_fielded_search) %>
                </dd>
            <% end -%>
        <% else %>
            <dt class="blacklight-<%= field_name.parameterize %>"><%= render_document_show_field_label document, field: field_name %></dt>
        <% end -%>

        <dd class="blacklight-<%= field_name.parameterize %>">
          <% if doc_presenter.configuration.show_fields.fetch(field_name)[:helper_method] %>
            <% values = Array.wrap(doc_presenter.field_value field_name) %>
          <% else %>
            <% values = document[field_name] %>
          <% end %>
          <% values.each do |value| %>
            <%= value %>
          <% end %>
        </dd>
      <% end -%>
    <% end -%>
  </dl>
</div>

<div class="availability_iframe panel panel-default">
  <h4 class="panel-heading">Availability</h4>
  <iframe class="bl_alma_iframe" src="<%= alma_app_fulfillment_url(document) %>"></iframe>
</div>
