<% doc_presenter = show_presenter(document) %>
<%# partial to display availability details in catalog show view -%>
<div class="col-sm-12">
<div id="record-view-iframe"  class="panel panel-default">
  <div class="panel-heading">
    <h4 id="availability-heading">Availability</h4>
  </div>


  <% if document.fetch("availability_facet", []).include?("Online") %>
    <% document_show_fields(document).each do |field_name, field| %>
    <% if field_name == 'electronic_resource_display' %>

      <div class="panel-body online-panel">
        <h5>Online</h5>
        <dd class="blacklight-<%= field_name.parameterize %>">
          <ul>
            <% doc_presenter.configuration.show_fields.fetch(field_name)[:helper_method] %>
            <% values = Array.wrap(doc_presenter.field_value field_name) %>
            <% values.each do |value| %>
              <li class="list_items"> <%= safe_join(Array.wrap(value)) %> </li>
            <% end %>
          </ul>
        </dd>
      </div>
      <% end %>
    <% end %>
  <% end %>

  <% if document.fetch("availability_facet", []).include?("At the Library") %>
    <% if document.fetch("availability_facet", []).include?("At the Library") && document.fetch("availability_facet", []).include?("Online") %>
      <div class="online-border"></div>
    <% end %>
    <div data-controller="show" data-show-url="<%= item_url(document.id) %>" class="physical-holding-panel panel-body">
      <div data-target="show.panel" class="panel-content" >
        <div data-target="show.spinner" class="spinner">
          <span class="glyphicon glyphicon-refresh glyphicon-spin" role="spinbutton"></span>
          Loading Availability
        </div>
      </div>
  <% end %>
  <%= render "aeon_request", :document => document %>
</div>
</div>
