<%# This template is used for the initial load of availability information in the availability panel %>
<%# It gets replaced by a similar template in almaws/item.html.erb, so changes need to be in both places %>

<% @document_availability = document_availability_info(document) %>

<% unless @document_availability.all?(&:empty?) %>
  <% sort_order_for_holdings(@document_availability).each do |key, items| %>
    <div data-long-list class="m-0" data-controller="availability">
      <div class="d-lg-flex table-heading ml-0 mb-0 border-bottom border-top border-header-grey bg-header-grey justify-content-lg-between avail-list">
        <div class="library-name card-title col-sm-12 col-md-8"><%= library_name_from_short_code(key) %></div>
        <div class="holdings-summary col-sm-12 col-md-4"><%= summary_list(items) %></div>
      </div>

      <%= render "asrs_instructions", key: key %>
      <%= render "scrc_instructions", key: key, document: document %>
      <%= render "main_open_shelving_instructions", key: key %>

      <% items.each do |item| %>
        <div class="item-info row avail-info-rows border-bottom border-header-grey p-sm-0 m-0">
          <!-- <div class="d-flex flex-sm-column no-gutters"> -->
            <div class="col-sm-12 col-md-2"><strong><%= location_status(item) %></strong></div>
            <div class="col-sm-12 col-md-2"><%= alternative_call_number(item) %></div>
            <div class="col-sm-12 col-md-4">
              <span><%= description(item) %></span>
              <span><%= public_note(item) %></span>
              <span><%= material_type(item) %></span>
            </div>
          <!-- </div> -->
          <div class="d-sm-flex flex-sm-column align-self-center pl-md-4 pl-sm-0 avail-spinner-container">
            <div class="spinner">
              <span class="fa fa-spinner" aria-busy="true" aria-live="polite"></span>
              <span>Loading Availability</span>
            </div>
          </div>
        </div>
      <% end %>
    </div>
  <% end %>

<% else %>
  <div id="error-message">We are unable to find availability information for this record. Please contact the library for more information.</div>
<% end %>
