<%= form_with url: hold_request_path, local: true, id: "hold-request-form", class: 'form-horizontal request-form', method: :post do |form| %>
  <div class="container" data-controller="form">

    <%= form.hidden_field :mms_id, value: params[:mms_id] %>
    <%= form.hidden_field :holding_id, value: @holding_id %>
    <%= form.hidden_field :item_pid, value: @item_pid %>
    <%= form.hidden_field :user_id, value: @user_id %>
    <%= form.hidden_field :request_level, value: @request_level %>

    <% if @equipment.empty?  && @request_level == "bib" %>
      <div class="row">
        <div class="col-sm-4 hold-form">
          <%= label("", :pickup_location, t("requests.form.pickup_locations_label")) %>
          <%= select("", :pickup_location, @pickup_locations.collect { |lib| [ lib.values.first, lib.keys.first ] }, {class: "request-form form-control"}, { include_blank: true, required: true, "aria-required": true }) %>
        </div>
      </div>
    <% end %>

    <% if @equipment.present? %>
      <div class="row">
        <div class="col-sm-4 hold-form">
          <%= label("", :pickup_location, t("requests.form.pickup_locations_label")) %>
          <%= select("", :pickup_location, @equipment.collect { |lib| [ lib.fetch("desc", ""), lib.fetch("value", "") ] }.uniq, {class: "request-form form-control"}, {include_blank: true, required: true, "aria-required": true }) %>
        </div>
      </div>
    <% end %>


    <% if @request_level == "item" %>
      <div class="form-group row">
        <div class="col-sm-4">
          <%= form.label(:description, t("requests.form.description_label")) %>
          <%= select_tag(:description, options_for_select(@description), { data: { "action": "form#select" }, class: "request-form form-control", include_blank: true, required: true, "aria-required": true } ) %>
        </div>
      </div>

      <div class="row">
        <div class="col-sm-4 hold-form">
          <%= label("", :pickup_location, t("requests.form.pickup_locations_label")) %>
          <%= select_tag(:pickup_location, grouped_options_for_select(item_level_library_name(@item_level_locations)), { data: { "target": "form.pickups" },  class: "request-form form-control", include_blank: true, required: true, "aria-required": true }) %>
        </div>
      </div>

    <% end %>

    <div class="row hold-form">
      <div class="col-sm-5">
        <%= form.label(:not_needed, t("requests.form.not_needed_after")) %>
        <%= date_field_tag :last_interest_date, "", pattern:"[0-9]{4}-[0-9]{2}-[0-9]{2}", id: "hold_date_field" %>
        <%= render "format_date_message" %>
      </div>
    </div>

    <div class="row hold-form">
      <div class="col-sm-4">
        <%= form.label(:comment, t("requests.form.notes_label")) %>
        <%= form.text_area :comment, class: "request-form form-control" %>
      </div>
    </div>

    <%= form.submit t("requests.form.submit"), class:"btn btn-primary" %>

  </div>
<% end %>
