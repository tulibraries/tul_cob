<%# Customized from Blacklight 8's default to reintroduce the "Start Over" link between the heading and the facets list %>
<% start_over_applicable = helpers.has_search_parameters? %>
<% constraints_component_class = helpers.blacklight_config&.view_config(helpers.document_index_view_type)&.constraints_component || Blacklight::ConstraintsComponent %>
<% constraint_params = helpers.controller&.params != helpers.params ? helpers.params : helpers.search_state %>
<% constraints_search_state =
     if constraint_params.is_a?(Blacklight::SearchState)
       constraint_params
     else
       search_state_class = helpers.controller&.respond_to?(:search_state_class) ? helpers.controller.search_state_class : Blacklight::SearchState
       search_state_class.new(constraint_params, helpers.blacklight_config, helpers)
     end %>

<%# main container for facets/limits menu -%>
<%= content_tag :div, id: @id,  class: 'facets sidenav facets-toggleable-md' do %>
  <div class="facets-header">
    <%= content_tag :h2, @title, class: 'limit-search-heading' if @title %>

    <%= content_tag :button,
      class: 'btn btn-outline-secondary facet-toggle-button d-block d-lg-none',
      type: 'button',
      data: {
        toggle: 'collapse',
        target: "##{@panel_id}",
        'bs-toggle': 'collapse',
        'bs-target': "##{@panel_id}"
      },
      aria: {
        controls: @panel_id,
        expanded: 'false',
      } do %>
      <span data-show-label><%= t('blacklight.search.facets.group.open') %></span>
      <span data-hide-label><%= t('blacklight.search.facets.group.close') %></span>
    <% end %>
  </div>

  <% if start_over_applicable %>
    <% constraints_component = constraints_component_class.new(search_state: constraints_search_state, render_headers: false, start_over_component: nil, id: nil, classes: 'constraints-container mb-2') %>
    <%= render constraints_component %>
    <div class="start-over-container mb-3">
      <%= render Blacklight::StartOverButtonComponent.new %>
    </div>
  <% end %>

  <div id="<%= @panel_id %>" class="facets-collapse collapse">
    <%= body %>
  </div>
<% end %>
